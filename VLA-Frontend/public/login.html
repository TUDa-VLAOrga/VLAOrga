<!DOCTYPE html>

<html>
    <head>
        <link rel="stylesheet" href="login.css">
    </head>

    <body>
        <div class="login-container">
            <form class="login-form" action="login.html" method="post">
                <h2 class="login-title">Login zum VLA Kalender</h2>

                <input
                    class="login-input"
                    type="text"
                    name="username"
                    placeholder="Benutzername"
                    required
                />

                <input
                    class="login-input"
                    type="password"
                    name="password"
                    placeholder="Passwort"
                    required
                />

                <input type="hidden" name="_csrf" id="csrf">

                <button type="submit" class="login-button">
                    Login
                </button>
            </form>
        </div>

        <script>
            fetch('/csrf', {
                credentials: 'same-origin'
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('csrf').value = data.token;
            })
            .catch(err => {
                console.log("CSRF could not be fetched");
                constole.log(err);

                // TODO: Integrate this properly
                document.body.innerHTML +=
                    (
                        "Die Authentifizierung kann gerade nicht erfolgen, bitte versuchen Sie es gleich erneut"
                    );
            });

            if (new URLSearchParams(document.location.search).has("error")) {
                
                // TODO: Integrate this properly
                document.body.innerHTML +=
                    (
                        "Die Anmeldedaten waren ung√ºltig, bitte versuchen Sie es erneut"
                    );
            }
        </script>
    </body>
</html>